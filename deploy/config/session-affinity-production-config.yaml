# Production EPP configuration with Session Affinity
#
# This configuration is optimized for production deployments.
# Cookie expires after 24 hours for better user experience.
#
# Fixed cookie attributes: Path=/, HttpOnly=true, Secure=false, SameSite=Lax
#
apiVersion: inference.networking.x-k8s.io/v1alpha1
kind: EndpointPickerConfig
plugins:
- type: prefix-cache-scorer
  parameters:
    hashBlockSize: 5
    maxPrefixBlocksToMatch: 256
- type: session-affinity-scorer
  parameters:
    maxAge: 86400  # 24 hours - cookie expires after 1 day
- type: decode-filter
- type: max-score-picker
- type: single-profile-handler
schedulingProfiles:
- name: default
  plugins:
  - pluginRef: decode-filter
  - pluginRef: max-score-picker
  - pluginRef: session-affinity-scorer
    weight: 100  # Highest priority for session affinity
  - pluginRef: prefix-cache-scorer
    weight: 50   # Cache locality for new sessions

